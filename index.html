<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>vue_test</title>
  <script src="http://libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>

  <link rel="stylesheet" type="text/css" href="../static/css/base.css">
  <link rel="stylesheet" type="text/css" href="../static/css/main.css">
  <link rel="stylesheet" href="../static/css/iconfont.css">
  <link rel="stylesheet" href="../static/css/swiper.min.css">
  <link rel="stylesheet" type="text/css" href="../staticcss/honeySwitch.css">

  <script src="../static/js/color.js"></script>
</head>
<body>
<div id="app"></div>
<!-- built files will be auto injected -->
</body>
<script src="../static/js/swiper.min.js"></script>
<script src="../static/js/mobileSelect.min.js" type="text/javascript"></script>
<script type="text/javascript" src="../static/js/jquery.touchSwipe.min.js"></script>
<script>
  var active = 0;
  // swiper
  var galleryThumbs = new Swiper('.gallery-thumbs', {
    slidesPerView: 5,
    spaceBetween: 0,
    slidesPerGroup: 5,
    freeMode: true,
    watchSlidesVisibility: true,
    watchSlidesProgress: true,
    loop: false,
    loopFillGroupWithBlank: true,
    pagination: {
      el: '.swiper-pagination',
      clickable: true,
    },
  });
  var galleryTop = new Swiper('.gallery-top', {
    navigation: {
      nextEl: '.swiper-button-next',
      prevEl: '.swiper-button-prev',
    },
    thumbs: {
      swiper: galleryThumbs
    },
    noSwiping: true,
    on: {
      touchStart: function (event) {
        if (this.activeIndex == 1) {
          galleryTop.allowSlidePrev = false;
        } else {
          galleryTop.allowSlidePrev = true;
        }
      },
      slideChange: function () {
        galleryThumbs.slideTo(this.activeIndex)
        //得到当前页
        active = this.activeIndex;

      }

    },
  });
  var setting = {
    open: "0",//0是关灯，1是开灯，如果开灯，那么要付给一些按钮的active状态,-1 是离线

    bantype: "1",//底板 分别是 0台灯 1顶灯  2全部按钮显示
    ban: [{
      name: "台灯",
      data: [0, 3, 5, 8, 9, 10, 11, 12, 13]
    }, {
      name: "顶灯",
      data: [0, 3, 4, 5, 6, 7, 9, 10, 12, 13]
    }, {
      name: "55",
      data: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
    }
    ],
    active: [3],
    data: [{
      //代号
      alt: "0",
      color: "#f8c067",
      moshi: "开灯",
      icon: '',
      display: "block",
      brightness: "1",//亮度0-1
      RGB: "0",//颜色0-1 1最黄
      zidingyi: "0",//自定义休息
      tiaoguang: "0",//暂时不用这个参数了
      shuimian: "0",//助眠功能
      qichuang: "0",//起床功能
      guangquan: "0",//光圈的透明度
      control: "0",//0 无调光 1 亮度调光 2色彩调光 3亮度和色彩调光
    }, {
      alt: "1",
      color: "#fdc743",
      moshi: "日光",
      icon: 'icon-taiyang',
      display: "block",
      brightness: "1",
      RGB: "0",
      zidingyi: "0",
      tiaoguang: "0",
      shuimian: "0",
      qichuang: "0",
      guangquan: "0",
      control: "0",
    }, {
      alt: "2",
      color: "#32b5e6",
      moshi: "月光",
      icon: 'icon-yueguang',
      display: "block",
      brightness: "1",
      RGB: "0",
      zidingyi: "0",
      tiaoguang: "0",
      shuimian: "0",
      qichuang: "0",
      guangquan: "0",
      control: "0",
    }, {
      alt: "3",
      color: "#fdc743",
      moshi: "调光",
      icon: '',
      display: "block",
      brightness: "1",
      RGB: "0",
      zidingyi: "0",
      tiaoguang: "1",
      shuimian: "0",
      qichuang: "0",
      guangquan: "0.8",
      control: "1",

    }, {
      alt: "4",
      color: "#2283e2",
      moshi: "会客",
      icon: 'icon-huike',
      display: "block",
      brightness: "1",
      RGB: "0",
      zidingyi: "0",
      tiaoguang: "0",
      shuimian: "0",
      qichuang: "0",
      guangquan: "0", control: "0",

    }, {
      alt: "5",
      color: "#69cb63",
      moshi: "阅读",
      icon: 'icon-yuedu',
      display: "block",
      brightness: "1",
      RGB: "0",
      zidingyi: "0",
      tiaoguang: "0",
      shuimian: "0",
      qichuang: "0",
      guangquan: "0", control: "0",
    }, {
      alt: "6",
      color: "#f5a623",
      moshi: "观影",
      icon: 'icon-guanying',
      display: "block",
      brightness: "1",
      RGB: "0",
      zidingyi: "0",
      tiaoguang: "0",
      shuimian: "0",
      qichuang: "0",
      guangquan: "0", control: "0",

    }, {
      alt: "7",
      color: "#f5a623",
      moshi: "就餐",
      icon: 'icon-jiucan',
      display: "block",
      brightness: "1",
      RGB: "0",
      zidingyi: "0",
      tiaoguang: "0",
      shuimian: "0",
      qichuang: "0",
      guangquan: "0", control: "0",

    }, {
      alt: "8",
      color: "#5bc4eb",
      moshi: "电脑",
      icon: 'icon-diannao',
      display: "block",
      brightness: "1",
      RGB: "0",
      zidingyi: "0",
      tiaoguang: "0",
      shuimian: "0",
      qichuang: "0",
      guangquan: "0",
      control: "3",

    }, {
      alt: "9",
      color: "#2283e2",
      moshi: "夜灯",
      icon: 'icon-yedeng',
      display: "block",
      brightness: "1",
      RGB: "0",
      zidingyi: "0",
      tiaoguang: "0",
      shuimian: "0",
      qichuang: "0",
      guangquan: "0", control: "0",

    }, {
      alt: "10",
      color: "#8fd88a",
      moshi: "睡眠",
      icon: 'icon-shuimian',
      display: "block",
      brightness: "1",
      RGB: "0",
      zidingyi: "0",
      tiaoguang: "0",
      shuimian: "1",
      qichuang: "0",
      guangquan: "0",
      control: "0",

    }, {
      alt: "11",
      color: "#f49601",
      moshi: "智能调光",
      icon: 'icon-zhinengtiaoguang',
      display: "block",
      brightness: "1",
      RGB: "0",
      zidingyi: "0",
      tiaoguang: "0",
      shuimian: "0",
      qichuang: "0",
      guangquan: "0",
      control: "0",

    }, {
      alt: "12",
      color: "#f5a623",
      moshi: "起床",
      icon: 'icon-jiaoxing',
      display: "block",
      brightness: "1",
      RGB: "0",
      zidingyi: "0",
      tiaoguang: "0",
      shuimian: "0",
      qichuang: "1",
      guangquan: "0",
      control: "0",

    },
      {
        alt: "13",
        color: "#f5a623",
        moshi: "月光",
        icon: 'icon-yueguang',
        display: "block",
        brightness: "1",
        RGB: "0",
        zidingyi: "0",
        tiaoguang: "0",
        shuimian: "0",
        qichuang: "0",
        guangquan: "0",
        control: "0",

      },
    ]
  }

  //延时关灯
  var mobileSelect2 = new MobileSelect({
    trigger: '#trigger2',
    title: '延时关灯',
    wheels: [{data: ['120分钟', '110分钟', '100分钟', '90分钟', '80分钟', '70分钟', '60分钟', '50分钟', '40分钟', '30分钟', '20分钟', '10分钟']}
    ],
    triggerDisplayData: false,
    flag: 0,
    position: [1, 1, 1],
    callback: function (indexArr, data) {
      dingshi = parseInt(data[0]);

    }
  });
  //右上角设置显示
  $(".more").click(function () {
    $(".xiala").show();
    $(".bg").show();

  })
  $(".bg").click(function () {
    $(".xiala").hide();
    $(".bg").hide();
  })
  // 点击右上角定时按钮，底部弹框出现
  var myVar;
  $(".dingshiguanji").click(function () {
    mobileSelect2.show();
  })
  // 助眠页面中间框
  var mobileSelect3 = new MobileSelect({
    trigger: '#trigger3',
    title: '助眠定时',
    wheels: [{data: ['120分钟', '110分钟', '100分钟', '90分钟', '80分钟', '70分钟', '60分钟', '50分钟', '40分钟', '30分钟', '20分钟', '10分钟']}
    ],
    triggerDisplayData: false,
    flag: 0,
    position: [9],
    callback: function (indexArr, data) {

      shuimian = parseInt(data[0]);
      $(".shuimian >.wenzi>span").html(data[0])
    }
  });
  //起床页面中间的框
  var mobileSelect4 = new MobileSelect({
    trigger: '#trigger4',
    title: '唤醒时长',
    wheels: [{data: ['1分钟', '2分钟', '3分钟', '4分钟', '5分钟']}
    ],
    triggerDisplayData: false,
    flag: 0,
    position: [3],
    callback: function (indexArr, data) {
      qichuang = parseInt(data[0]);
      $(".qichuang >.wenzi>span").html(data[0])
    }
  });
  //激活按钮
  var jihuo = function (el) {
    var index = el.attr("alt");
    if (index == "5" || index == "6") {
      $(".swiper-slide ").removeClass("active");
      $(".kaiguan ").addClass("active");
      active = index;
      el.addClass("active");
    } else {
      el.addClass("active");
      $(".gallery-thumbs .swiper-slide ").eq(5).removeClass("active");
      $(".gallery-thumbs .swiper-slide ").eq(6).removeClass("active");
    }

  }
  //关闭按钮
  var guanbi = function (el) {
    var index = el.attr("alt");
    el.removeClass("active");
    //如果没有其他按钮开着，就关机

    if ($(".gallery-thumbs .active").length < 2) {
      guanji();
    }
  }
  //关机
  var guanji = function () {
    $(".swiper-slide ").removeClass("active");
    $(".gallery-top .swiper-slide ").eq(0).show();
    galleryTop.slideTo(0);
  }
  //按钮处理
  var button = function () {
    //取得哪些按钮激活
    var activeArry = setting.active;
    $(".gallery-thumbs .swiper-slide").each(function () {
      var display = false;
      for (i in activeArry) {
        if ($(this).attr("alt") == activeArry[i]) {
          $(this).addClass("active")
        }
      }
    })
    $(".kaiguan").addClass("active")
    galleryTop.slideTo(activeArry[0]);
  }
  //延时
  $(".ensure").toggle(function () {
    $(".yanshi").addClass("active");
    $(".icon-father").hide();

    $(".yanshi-box").show();
  }, function () {
    $(".yanshi").removeClass("active");
    $(".icon-father").show();

    $(".yanshi-box").hide();
  })
  //调节亮度和颜色
  //adjust代表是 有没有开调节，0 没有开调节， 1 左右调节（颜色） 2  上下调节（亮度）
  var adjust = 0;
  var brightness = 0;
  var RGB = 0;
  var r = 10;
  //调节亮度
  var tbcontrol = function () {
    $("#controlbox").swipe("disable");
    $("#control").swipe("enable");
    $("#control").show();
    $(".tb").show();
    brightness = setting.data[active].brightness;
    RGB = setting.data[active].RGB;
    $("#control").swipe({
      swipeStatus: function (event, phase, direction, distance, duration, fingers, fingerData, currentDirection, fingerCount) {
        adjust = 1;

        console.log('adjust', adjust)
        $(".tbflag").css("margin-top", brightness + "px");
        // $(".lrflag").css("margin-left", RGB + "px");
        //上下调节
        if (adjust == 1) {
          var i = 240 - (brightness * 240);
          var j = 0;
          if (direction == "down") {
            j = distance
          } else if (direction == "up") {
            j = -distance;
          }
          j = i + j;
          if (j > 228) {
            j = 228;
          } else if (j < 0) {
            j = 0;
          }

          $(".tbflag").css({"margin-top": j + "px"});
          $(".box_bg").css("opacity", 1 - j / 480);
          $(".box_bg").attr("opacity", 1 - j / 240);
          $(".zhuti").css("opacity", 1 - j / 480);
          $(".zhuti").attr("opacity", 1 - j / 240);

        }
      },
      threshold: 20,
      maxTimeThreshold: 50,
      fingers: 1
    });

  }
  tbcontrol();
  //调节颜色
  var lrcontrol = function () {
    $("#controlbox").swipe("disable");
    $("#contro2").swipe("enable");
    $("#contro2").show();
    $(".lr").show();
    brightness = setting.data[active].brightness;
    RGB = setting.data[active].RGB;
    $("#contro2").swipe({
      swipeStatus: function (event, phase, direction, distance, duration, fingers, fingerData, currentDirection, fingerCount) {
        adjust = 2;

        // if (phase == "end") {
        //   //$(".finger").fadeOut();
        //   // $(".tb").fadeOut();
        //   $(".lr").fadeOut();
        //   $("#contro2").swipe("disable");
        //   $("#controlbox").swipe("enable");
        //   // brightness = parseInt($(".tbflag").css("margin-top") + r + 0.1);
        //
        //   RGB = parseInt($(".lrflag").css("margin-top") + r + 0.1);
        //
        //   setting.data[active].brightness = $(".box_bg").css("opacity");
        //
        //   setting.data[active].RGB = $(".zhuti_huang").css("opacity");
        // } else {
          //左右调节
          if (adjust == 2) {
            console.log(2)

            var i = (RGB * 240);
            var j = 0;
            if (direction == "right") {
              j = distance
            } else if (direction == "left") {
              j = -distance;
            }
            j = i + j;
            if (j > 240) {
              j = 240;
            } else if (j < 0) {
              j = 0;
            }
            $(".lrflag").css({"margin-left": j + "px"})
            $(".gallery-top .swiper-slide").css("opacity", j / 240);
          // }
        }
        // $(".finger").css({ "left": fingerData[0].end.x, "top": fingerData[0].end.y, display: "block" });

      },
      threshold: 20,
      maxTimeThreshold: 50,
      fingers: 1
    });
  }
  lrcontrol();


</script>
</html>
